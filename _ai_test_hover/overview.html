<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>particles.js â€” æ¦‚è¦ãƒ“ãƒ¥ã‚¢</title>
    <link
      href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Segoe UI", sans-serif;
        background: #0d1117;
        color: #c9d1d9;
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      /* â”€â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€â”€ */
      #header {
        background: #161b22;
        border-bottom: 1px solid #30363d;
        padding: 10px 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        flex-shrink: 0;
      }
      #header h1 {
        font-size: 0.95rem;
        color: #e6edf3;
        font-weight: 600;
      }
      .badge {
        background: #21262d;
        border: 1px solid #30363d;
        border-radius: 20px;
        padding: 2px 10px;
        font-size: 0.7rem;
        color: #8b949e;
      }
      #esc-hint {
        margin-left: auto;
        font-size: 0.7rem;
        color: #484f58;
        opacity: 0;
        transition: opacity 0.3s;
      }
      #esc-hint.show {
        opacity: 1;
      }

      /* â”€â”€â”€ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ â”€â”€â”€ */
      #layout {
        display: flex;
        flex: 1;
        overflow: hidden;
      }

      /* â•â•â•â•â•â•â•â•â•â•â•â• å·¦ãƒ‘ãƒãƒ« â•â•â•â•â•â•â•â•â•â•â•â• */
      #left-panel {
        width: 315px;
        min-width: 315px;
        background: #0d1117;
        border-right: 1px solid #21262d;
        overflow-y: auto;
        padding: 14px 12px;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      /* â”€â”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ãƒ™ãƒ« â”€â”€ */
      .section-label {
        font-size: 0.65rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #484f58;
        padding: 10px 0 3px;
      }
      /* é‡è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆèµ·å‹•æ™‚ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼‰ã¯æ˜ã‚‹ã */
      .section-label.primary {
        color: #cba6f7;
        font-size: 0.73rem;
        padding: 12px 0 5px;
        text-shadow: 0 0 12px rgba(203, 166, 247, 0.3);
      }

      /* â”€â”€ fn-box â”€â”€ */
      .fn-box {
        background: #161b22;
        border: 1px solid #30363d;
        border-radius: 8px;
        padding: 9px 11px;
        cursor: pointer;
        transition:
          border-color 0.15s,
          background 0.15s,
          box-shadow 0.15s;
        user-select: none;
        position: relative;
      }
      .fn-box:hover {
        background: #1c2128;
        border-color: #58a6ff;
      }
      .fn-box.active {
        border-color: #f0b429 !important;
        background: #1c1a0f;
        box-shadow: 0 0 0 2px #f0b42930;
      }

      /* é‡è¦ãƒœãƒƒã‚¯ã‚¹ï¼ˆèµ·å‹•æ™‚ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã®ä¸­èº«ï¼‰*/
      .fn-box.primary {
        background: #13182a;
        border-color: #2d3550;
        box-shadow: 0 0 0 1px #3843700040;
      }
      .fn-box.primary:hover {
        border-color: #7aa2f7;
        background: #181f36;
      }

      .fn-name {
        font-family: "Cascadia Code", "Consolas", monospace;
        font-size: 0.82rem;
        color: #58a6ff;
        font-weight: 600;
      }
      .fn-box.primary .fn-name {
        color: #7aa2f7;
      }
      .fn-box.active .fn-name {
        color: #f0b429;
      }
      .fn-desc {
        font-size: 0.71rem;
        color: #8b949e;
        margin-top: 3px;
        line-height: 1.5;
      }

      /* è‰²ç¨®åˆ¥ */
      .event {
        border-left: 3px solid #cba6f7;
      }
      .util {
        border-left: 3px solid #3fb950;
      }
      .loop {
        border-left: 3px solid #374768;
      }
      .cfg {
        border-left: 3px solid #f0883e;
      }
      .struct {
        background: #12111a;
        border: 1px dashed #30363d;
        cursor: default;
      }
      .struct:hover {
        background: #12111a;
        border-color: #30363d;
        box-shadow: none;
      }

      .arrow {
        text-align: center;
        color: #484f58;
        font-size: 0.75rem;
        padding: 1px 0;
      }
      .arrow.primary {
        color: #7aa2f7;
      }

      .loop-group {
        border: 1px solid #1f3040;
        border-radius: 10px;
        padding: 9px;
        background: #07111a;
        display: flex;
        flex-direction: column;
        gap: 4px;
        position: relative;
        opacity: 0.7;
      }
      .loop-group::before {
        content: "ğŸ”„ æ¯ãƒ•ãƒ¬ãƒ¼ãƒ ";
        position: absolute;
        top: -9px;
        left: 10px;
        background: #07111a;
        padding: 0 6px;
        font-size: 0.6rem;
        color: #374768;
        font-weight: 700;
      }
      .sub-group {
        display: flex;
        gap: 5px;
        padding-left: 8px;
      }
      .fn-box.small .fn-name {
        font-size: 0.73rem;
      }
      .fn-box.small .fn-desc {
        font-size: 0.65rem;
      }

      .config-grid {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 2px 10px;
        font-size: 0.71rem;
      }
      .config-grid span:nth-child(odd) {
        font-family: monospace;
        color: #e3b341;
      }
      .config-grid span:nth-child(even) {
        font-family: monospace;
        color: #3fb950;
        text-align: right;
      }
      .struct-grid {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 3px 10px;
        font-size: 0.71rem;
      }
      .struct-grid .key {
        font-family: monospace;
        color: #79c0ff;
      }
      .struct-grid .val {
        color: #8b949e;
      }

      /* â•â•â•â•â•â•â•â•â•â•â•â• å³ãƒ‘ãƒãƒ« â•â•â•â•â•â•â•â•â•â•â•â• */
      #right-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      #right-header {
        background: #161b22;
        border-bottom: 1px solid #30363d;
        padding: 7px 16px;
        font-size: 0.75rem;
        color: #8b949e;
        flex-shrink: 0;
      }
      #right-header span {
        color: #58a6ff;
        font-family: monospace;
      }

      /* â”€â”€ ãƒŠãƒ“ãƒãƒ¼ â”€â”€ */
      #nav-bar {
        background: #0d1117;
        border-bottom: 1px solid #21262d;
        padding: 5px 10px;
        display: flex;
        align-items: center;
        gap: 6px;
        min-height: 36px;
        flex-shrink: 0;
      }
      #back-btn {
        background: #21262d;
        border: 1px solid #30363d;
        border-radius: 5px;
        color: #8b949e;
        font-size: 0.72rem;
        padding: 3px 10px;
        cursor: pointer;
        transition:
          background 0.15s,
          color 0.15s;
        white-space: nowrap;
      }
      #back-btn:hover:not(:disabled) {
        background: #30363d;
        color: #e6edf3;
      }
      #back-btn:disabled {
        opacity: 0.3;
        cursor: default;
      }
      #breadcrumb {
        display: flex;
        align-items: center;
        gap: 3px;
        flex-wrap: wrap;
        overflow: hidden;
      }
      .bc-hint {
        color: #484f58;
        font-size: 0.7rem;
      }
      .bc-item {
        color: #58a6ff;
        cursor: pointer;
        font-family: monospace;
        font-size: 0.72rem;
        padding: 1px 7px;
        border-radius: 4px;
        transition: background 0.15s;
      }
      .bc-item:hover {
        background: #21262d;
      }
      .bc-current {
        color: #f0b429;
        font-family: monospace;
        font-size: 0.72rem;
        background: #1a1500;
        border: 1px solid #f0b42930;
        padding: 1px 7px;
        border-radius: 4px;
        font-weight: 600;
      }
      .bc-sep {
        color: #30363d;
        font-size: 0.7rem;
      }

      /* â”€â”€ ã‚³ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒŠ â”€â”€ */
      #code-container {
        flex: 1;
        overflow-y: auto;
        position: relative;
        background: #1e1e2e;
      }
      #spotlight-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        pointer-events: none;
        z-index: 3;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      #line-highlight {
        position: absolute;
        left: 0;
        right: 0;
        background: rgba(240, 180, 41, 0.12);
        border-left: 3px solid rgba(240, 180, 41, 0.9);
        box-shadow: inset 0 0 0 1px rgba(240, 180, 41, 0.08);
        pointer-events: none;
        opacity: 0;
        transition:
          top 0.25s ease,
          height 0.25s ease,
          opacity 0.2s ease;
        z-index: 5;
      }
      /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ï¼ˆãƒã‚¤ãƒ©ã‚¤ãƒˆå³æ¨ªè¿½å¾“ï¼‰ */
      #back-float {
        position: absolute;
        right: 12px;
        background: rgba(22, 27, 34, 0.92);
        border: 1px solid #f0b42980;
        border-radius: 20px;
        color: #f0b429;
        font-size: 0.73rem;
        font-weight: 600;
        padding: 5px 14px;
        cursor: pointer;
        opacity: 0;
        pointer-events: none;
        transform: translateX(6px);
        transition:
          opacity 0.2s ease,
          transform 0.2s ease,
          top 0.25s ease;
        z-index: 10;
        white-space: nowrap;
        user-select: none;
      }
      #back-float.visible {
        opacity: 1;
        pointer-events: auto;
        transform: translateX(0);
      }
      #back-float:hover {
        background: rgba(35, 30, 5, 0.98);
        border-color: #f0b429;
      }

      pre[class*="language-"] {
        margin: 0;
        border-radius: 0;
        background: #1e1e2e !important;
        font-size: 13px;
        tab-size: 4;
        padding-bottom: 50vh !important;
      }
      code[class*="language-"] {
        font-size: 13px;
      }
      #loading-msg {
        padding: 40px;
        color: #484f58;
        font-size: 0.85rem;
      }

      /* Ctrl+Clickã§ãã‚‹é–¢æ•°å */
      #code-el .token.function.fn-link {
        cursor: crosshair;
        border-bottom: 1px dotted rgba(88, 166, 255, 0.5);
        transition: background 0.1s;
      }
      #code-el .token.function.fn-link:hover {
        background: rgba(88, 166, 255, 0.12);
        border-bottom-style: solid;
        border-radius: 2px;
      }
      body.ctrl-held #code-el .token.function.fn-link {
        cursor: pointer;
        background: rgba(88, 166, 255, 0.18);
        border-bottom-color: #58a6ff;
      }

      /* â•â•â•â•â•â•â•â•â•â•â•â• AIãƒ›ãƒãƒ¼ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ— â•â•â•â•â•â•â•â•â•â•â•â• */
      #fn-tooltip {
        position: fixed;
        background: #161b22;
        border: 1px solid #30363d;
        border-radius: 10px;
        padding: 12px 14px;
        max-width: 260px;
        font-size: 0.73rem;
        color: #c9d1d9;
        line-height: 1.65;
        z-index: 999;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.15s;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
      }
      #fn-tooltip.show {
        opacity: 1;
      }
      #fn-tooltip .tip-role {
        font-size: 0.62rem;
        color: #3fb950;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.06em;
        margin-bottom: 5px;
      }
      #fn-tooltip .tip-name {
        font-family: monospace;
        color: #7aa2f7;
        font-weight: 700;
        font-size: 0.82rem;
        margin-bottom: 6px;
      }
      #fn-tooltip .tip-body {
        color: #b0bcc8;
      }
      #fn-tooltip .tip-hint {
        margin-top: 8px;
        font-size: 0.65rem;
        color: #484f58;
        border-top: 1px solid #21262d;
        padding-top: 6px;
      }
    </style>
  </head>
  <body>
    <div id="header">
      <h1>ğŸ† particles.js æ¦‚è¦ãƒ“ãƒ¥ã‚¢</h1>
      <span class="badge">å·¦ãƒ–ãƒ­ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆ</span>
      <span class="badge"
        >ã‚³ãƒ¼ãƒ‰å†…é–¢æ•°åã¯ <kbd>Ctrl</kbd>+ã‚¯ãƒªãƒƒã‚¯ã§ã‚¸ãƒ£ãƒ³ãƒ—</span
      >
      <span id="esc-hint">ESC ã§ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆè§£é™¤</span>
    </div>

    <div id="layout">
      <!-- â•â•â•â•â• å·¦ãƒ‘ãƒãƒ« â•â•â•â•â• -->
      <div id="left-panel">
        <!-- âš¡ èµ·å‹•æ™‚ï¼ˆé‡è¦ï¼‰ -->
        <div class="section-label primary">âš¡ èµ·å‹•æ™‚</div>
        <div
          class="fn-box primary"
          data-start="137"
          data-end="140"
          data-name="resizeCanvas()"
          data-tip-role="å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼šèµ·å‹•æ™‚ + ãƒªã‚µã‚¤ã‚ºæ™‚"
          data-tip="ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦ canvas ã®å¹…ã¨é«˜ã•ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã€‚<br>ã“ã‚ŒãŒãªã„ã¨ç”»é¢ã‚’åºƒã’ã¦ã‚‚æç”»ç¯„å›²ãŒç‹­ã„ã¾ã¾ã«ãªã‚‹ã€‚<br><br>window.resize ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚‚å‘¼ã°ã‚Œã‚‹ãŸã‚ã€ãƒªã‚µã‚¤ã‚ºã®ãŸã³ã«å†èª¿æ•´ã•ã‚Œã‚‹ã€‚"
        >
          <div class="fn-name">resizeCanvas()</div>
          <div class="fn-desc">ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã«åˆã‚ã›ã‚‹</div>
        </div>
        <div class="arrow primary">â†“ èµ·å‹•</div>
        <div
          class="fn-box primary"
          data-start="119"
          data-end="132"
          data-name="animate()"
          data-tip-role="å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼šèµ·å‹•æ™‚ã«1å›å‘¼ã¶ã ã‘ã§æ°¸ç¶šåŒ–"
          data-tip="requestAnimationFrame(animate) ã§è‡ªåˆ†ã‚’æ¬¡ãƒ•ãƒ¬ãƒ¼ãƒ ã«ç™»éŒ²ã—ç¶šã‘ã‚‹<strong>ç„¡é™ãƒ«ãƒ¼ãƒ—</strong>ã€‚<br><br>ã‚²ãƒ¼ãƒ ã®ã€Œãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ã€ã«ã‚ãŸã‚Šã€æ¯ç§’60å›ç¨‹åº¦å‘¼ã°ã‚Œã¦ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«å…¨ä½“ã‚’æ›´æ–°ãƒ»æç”»ã™ã‚‹ã€‚"
        >
          <div class="fn-name">animate()</div>
          <div class="fn-desc">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—ã‚’é–‹å§‹</div>
        </div>

        <!-- ğŸ‘† ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼ˆé‡è¦ï¼‰ -->
        <div class="section-label primary">ğŸ‘† ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼ˆã‚¯ãƒªãƒƒã‚¯ï¼‰</div>
        <div
          class="fn-box primary event"
          data-start="144"
          data-end="154"
          data-name="canvas click"
          data-tip-role="ãƒˆãƒªã‚¬ãƒ¼ï¼šã‚¯ãƒªãƒƒã‚¯ / ã‚¿ãƒƒãƒ"
          data-tip="ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸåº§æ¨™ (clientX, clientY) ã‚’å–å¾—ã—ã¦ explode() ã¸æ¸¡ã™ã€‚<br><br>ã‚¿ãƒƒãƒæ“ä½œï¼ˆã‚¹ãƒãƒ›ï¼‰ç”¨ã® touchstart ã‚‚åŒã˜ä»•çµ„ã¿ã§å‡¦ç†ã€‚{ passive: false } ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã„ã§ã„ã‚‹ã€‚"
        >
          <div class="fn-name">canvas click ã‚¤ãƒ™ãƒ³ãƒˆ</div>
          <div class="fn-desc">ã‚¯ãƒªãƒƒã‚¯åº§æ¨™ (x, y) ã‚’å–å¾—ã—ã¦ explode ã¸</div>
        </div>
        <div class="arrow primary">â†“</div>
        <div
          class="fn-box primary"
          data-start="64"
          data-end="68"
          data-name="explode()"
          data-tip-role="å½¹å‰²ï¼šçˆ†ç™ºã®èµ·çˆ†è£…ç½®"
          data-tip="createParticle ã‚’ CONFIG.particleCountï¼ˆ= 80ï¼‰å›å‘¼ã³ã€ç”Ÿæˆã•ã‚ŒãŸãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚’é…åˆ—ã«ä¸€æ°—ã«è¿½åŠ ã™ã‚‹ã€‚<br><br>1å›ã®ã‚¯ãƒªãƒƒã‚¯ã§80å€‹ã®ç²’å­ãŒç¬æ™‚ã«èª•ç”Ÿã™ã‚‹ã€‚"
        >
          <div class="fn-name">explode(x, y)</div>
          <div class="fn-desc">æŒ‡å®šåº§æ¨™ã§ä¸€æ–‰çˆ†ç™ºï¼</div>
        </div>
        <div class="arrow primary">â†“ 80å€‹ç”Ÿæˆ</div>
        <div
          class="fn-box primary"
          data-start="45"
          data-end="57"
          data-name="createParticle()"
          data-tip-role="å½¹å‰²ï¼šãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«1å€‹ã®è¨­è¨ˆå›³"
          data-tip="ãƒ©ãƒ³ãƒ€ãƒ ãªè§’åº¦ï¼ˆ0ã€œ2Ï€ï¼‰ã¨é€Ÿåº¦ã‹ã‚‰ã€<br>vx = cos(Î¸)Ã—speedã€vy = sin(Î¸)Ã—speed ã‚’è¨ˆç®—ã—ã¦åˆé€Ÿã‚’è¨­å®šã€‚<br><br>ä¸‰è§’é–¢æ•°ã§å…¨æ–¹å‘ã«å‡ç­‰ã«åºƒãŒã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã€‚"
        >
          <div class="fn-name">createParticle(x, y)</div>
          <div class="fn-desc">ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«1ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¦è¿”ã™</div>
        </div>
        <div class="arrow">â†™ å†…éƒ¨ã§ä½¿ç”¨</div>
        <div class="sub-group">
          <div
            class="fn-box util small"
            data-start="26"
            data-end="28"
            data-name="randomBetween()"
            data-tip-role="ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£"
            data-tip="minã€œmax ã®å®Ÿæ•°ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¿”ã™ã€‚<br>Math.random() ã¯ 0ã€œ1 ãªã®ã§ (max-min) ã‚’æ›ã‘ã¦ min ã‚’è¶³ã™ã€‚é€Ÿåº¦ãƒ»ã‚µã‚¤ã‚ºã®åˆæœŸå€¤ã«åºƒãä½¿ã‚ã‚Œã‚‹ã€‚"
          >
            <div class="fn-name">randomBetween()</div>
            <div class="fn-desc">minã€œmaxã®ä¹±æ•°</div>
          </div>
          <div
            class="fn-box util small"
            data-start="33"
            data-end="36"
            data-name="randomColor()"
            data-tip-role="ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£"
            data-tip="0ã€œ359 ã®è‰²ç›¸ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã‚“ã§ hsl() æ–‡å­—åˆ—ã‚’è¿”ã™ã€‚<br>å½©åº¦100%ãƒ»æ˜åº¦60%ã«å›ºå®šã™ã‚‹ã“ã¨ã§ã€ãã™ã‚“ã è‰²ã‚’é¿ã‘å¸¸ã«é®®ã‚„ã‹ãªèŠ±ç«è‰²ã ã‘ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚"
          >
            <div class="fn-name">randomColor()</div>
            <div class="fn-desc">HSLãƒ©ãƒ³ãƒ€ãƒ è‰²</div>
          </div>
        </div>

        <!-- ğŸ” ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—ï¼ˆè£œè¶³ï¼‰ -->
        <div class="section-label">ğŸ” ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—ï¼ˆæ¯ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰</div>
        <div class="loop-group">
          <div
            class="fn-box loop"
            data-start="119"
            data-end="132"
            data-name="animate()"
          >
            <div class="fn-name">animate()</div>
            <div class="fn-desc">rAF ã§è‡ªåˆ†ã‚’å†å¸°å‘¼ã³å‡ºã—</div>
          </div>
          <div class="arrow">â†“</div>
          <div
            class="fn-box loop"
            data-start="111"
            data-end="114"
            data-name="clearCanvas()"
          >
            <div class="fn-name">clearCanvas()</div>
            <div class="fn-desc">åŠé€æ˜å¡—ã‚Šã¤ã¶ã—ï¼ˆæ®‹åƒåŠ¹æœï¼‰</div>
          </div>
          <div class="arrow">â†“ å…¨ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã«ãƒ«ãƒ¼ãƒ—</div>
          <div
            class="fn-box loop"
            data-start="74"
            data-end="81"
            data-name="updateParticle()"
          >
            <div class="fn-name">updateParticle(p)</div>
            <div class="fn-desc">é‡åŠ›ãƒ»æ‘©æ“¦ã§ä½ç½®ã‚’1ãƒ•ãƒ¬ãƒ¼ãƒ é€²ã‚ã‚‹</div>
          </div>
          <div class="arrow">â†“</div>
          <div
            class="fn-box loop"
            data-start="87"
            data-end="95"
            data-name="drawParticle()"
          >
            <div class="fn-name">drawParticle(p)</div>
            <div class="fn-desc">é€æ˜åº¦ä»˜ãã§ã‚­ãƒ£ãƒ³ãƒã‚¹ã«æç”»</div>
          </div>
          <div class="arrow">â†“</div>
          <div
            class="fn-box loop"
            data-start="102"
            data-end="104"
            data-name="isAlive()"
          >
            <div class="fn-name">isAlive(p) â†’ false â†’ å‰Šé™¤</div>
            <div class="fn-desc">life ãŒ 0 ä»¥ä¸‹ã«ãªã£ãŸã‚‰ splice ã§é™¤å»</div>
          </div>
        </div>

        <div class="section-label">âš™ï¸ CONFIG â€” è¨­å®šå€¤</div>
        <div
          class="fn-box cfg"
          data-start="10"
          data-end="19"
          data-name="CONFIG"
        >
          <div class="config-grid">
            <span>particleCount</span><span>80</span> <span>gravity</span
            ><span>0.15</span> <span>friction</span><span>0.98</span>
            <span>minSpeed / maxSpeed</span><span>2ã€œ10</span>
            <span>lifespan</span><span>1.0</span> <span>decayRate</span
            ><span>0.015</span>
          </div>
        </div>

        <div class="section-label">ğŸ“¦ Particle ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ </div>
        <div
          class="fn-box struct"
          data-start="45"
          data-end="57"
          data-name="Particleæ§‹é€ "
        >
          <div class="struct-grid">
            <span class="key">x, y</span
            ><span class="val">ä½ç½®ï¼ˆã‚¯ãƒªãƒƒã‚¯åº§æ¨™ã‹ã‚‰å§‹ã¾ã‚‹ï¼‰</span>
            <span class="key">vx, vy</span
            ><span class="val">é€Ÿåº¦ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆè§’åº¦ã¨speedã‹ã‚‰ï¼‰</span>
            <span class="key">radius</span><span class="val">åŠå¾„ 2ã€œ5 px</span>
            <span class="key">color</span
            ><span class="val">HSLãƒ©ãƒ³ãƒ€ãƒ ã‚«ãƒ©ãƒ¼</span>
            <span class="key">life</span
            ><span class="val">æ®‹å­˜ãƒ©ã‚¤ãƒ• 1.0 â†’ 0 ã§æ¶ˆæ»…</span>
          </div>
        </div>
      </div>
      <!-- /left-panel -->

      <!-- â•â•â•â•â• å³ãƒ‘ãƒãƒ« â•â•â•â•â• -->
      <div id="right-panel">
        <div id="right-header">ğŸ“„ <span>particles.js</span> â€” 159è¡Œ</div>
        <div id="nav-bar">
          <button id="back-btn" disabled title="1ã¤å‰ã®é–¢æ•°ã«æˆ»ã‚‹">
            â† æˆ»ã‚‹
          </button>
          <div id="breadcrumb">
            <span class="bc-hint"
              >ğŸ“ å·¦ã®é–¢æ•°ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆè¡¨ç¤ºã•ã‚Œã¾ã™</span
            >
          </div>
        </div>
        <div id="code-container">
          <div id="spotlight-overlay"></div>
          <div id="line-highlight"></div>
          <div id="back-float">â† æˆ»ã‚‹</div>
          <div id="loading-msg">
            â³ particles.js ã‚’èª­ã¿è¾¼ã¿ä¸­...ï¼ˆLive Server ã§é–‹ã„ã¦ãã ã•ã„ï¼‰
          </div>
          <pre
            id="code-pre"
            class="language-javascript line-numbers"
            style="display: none"
          ><code id="code-el"></code></pre>
        </div>
      </div>
    </div>

    <!-- AIãƒ›ãƒãƒ¼ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ— -->
    <div id="fn-tooltip">
      <div class="tip-role" id="tip-role"></div>
      <div class="tip-name" id="tip-name"></div>
      <div class="tip-body" id="tip-body"></div>
      <div class="tip-hint">ã‚¯ãƒªãƒƒã‚¯ã§ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆè¡¨ç¤º</div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script>
      const codeEl = document.getElementById("code-el");
      const codePre = document.getElementById("code-pre");
      const codeContainer = document.getElementById("code-container");
      const hlBox = document.getElementById("line-highlight");
      const spotOverlay = document.getElementById("spotlight-overlay");
      const breadcrumb = document.getElementById("breadcrumb");
      const backBtn = document.getElementById("back-btn");
      const backFloat = document.getElementById("back-float");
      const escHint = document.getElementById("esc-hint");
      const loadingMsg = document.getElementById("loading-msg");
      const tooltip = document.getElementById("fn-tooltip");

      let currentActive = null;
      let spotlitActive = false;
      const navStack = [];

      // é–¢æ•°å â†’ è¡Œç¯„å›²ãƒãƒƒãƒ—
      const fnMap = {};
      document
        .querySelectorAll(".fn-box[data-start][data-name]")
        .forEach((box) => {
          const raw = box.dataset.name.trim();
          const bare = raw.replace(/\(.*\)$/, "");
          const entry = {
            start: parseInt(box.dataset.start, 10),
            end: parseInt(box.dataset.end, 10),
            box,
            name: raw,
          };
          fnMap[bare] = entry;
          fnMap[raw] = entry;
        });

      // â”€â”€â”€ ã‚½ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ â”€â”€â”€
      fetch("./particles.js")
        .then((r) => {
          if (!r.ok)
            throw new Error("fetch å¤±æ•—ï¼ˆLive Server ã§é–‹ã„ã¦ãã ã•ã„ï¼‰");
          return r.text();
        })
        .then((src) => {
          loadingMsg.style.display = "none";
          codePre.style.display = "block";
          codeEl.textContent = src;
          Prism.highlightElement(codeEl);
          setupCodeLinks();
        })
        .catch((err) => {
          loadingMsg.textContent = "âš  " + err.message;
        });

      // â”€â”€â”€ Ctrlã‚­ãƒ¼è¡¨ç¤º â”€â”€â”€
      document.addEventListener("keydown", (e) => {
        if (e.key === "Control") document.body.classList.add("ctrl-held");
        if (e.key === "Escape") clearSpotlight();
      });
      document.addEventListener("keyup", (e) => {
        if (e.key === "Control") document.body.classList.remove("ctrl-held");
      });

      // â”€â”€â”€ ã‚³ãƒ¼ãƒ‰å†…Ctrl+Click â”€â”€â”€
      function setupCodeLinks() {
        document
          .querySelectorAll("#code-el .token.function")
          .forEach((span) => {
            const name = span.textContent.trim();
            if (!fnMap[name]) return;
            span.classList.add("fn-link");
            span.title = `Ctrl+ã‚¯ãƒªãƒƒã‚¯ã§ ${fnMap[name].name} ã®å®šç¾©ã¸ã‚¸ãƒ£ãƒ³ãƒ—`;
            span.addEventListener("click", (e) => {
              if (!e.ctrlKey) return;
              e.stopPropagation();
              const { start, end, box, name: label } = fnMap[name];
              highlightLines(start, end, box, label);
            });
          });
      }

      // â”€â”€â”€ ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆè§£é™¤ â”€â”€â”€
      function clearSpotlight() {
        spotOverlay.style.opacity = "0";
        hlBox.style.opacity = "0";
        spotlitActive = false;
        escHint.classList.remove("show");
        if (currentActive) {
          currentActive.classList.remove("active");
          currentActive = null;
        }
      }

      // â”€â”€â”€ ãƒã‚¤ãƒ©ã‚¤ãƒˆ â”€â”€â”€
      function highlightLines(
        startLine,
        endLine,
        box,
        name,
        addHistory = true,
      ) {
        const lineRows = codePre.querySelector(".line-numbers-rows");
        if (!lineRows) return;
        const spans = Array.from(lineRows.querySelectorAll("span"));
        if (startLine > spans.length) return;

        const s = spans[startLine - 1];
        const e = spans[Math.min(endLine, spans.length) - 1];

        // offsetTop ã§çµ¶å¯¾ä½ç½®ã‚’è¨ˆç®—ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã«ä¾å­˜ã—ãªã„å®‰å®šã—ãŸå€¤ï¼‰
        const top = codePre.offsetTop + lineRows.offsetTop + s.offsetTop;
        const height = e.offsetTop + e.offsetHeight - s.offsetTop;

        hlBox.style.top = top + "px";
        hlBox.style.height = height + "px";
        hlBox.style.opacity = "1";
        backFloat.style.top = top + 4 + "px";

        spotlitActive = true;
        escHint.classList.add("show");

        // ãƒã‚¤ãƒ©ã‚¤ãƒˆã®ä¸­å¿ƒã‚’ã‚³ãƒ³ãƒ†ãƒŠã®ä¸­å¤®ã«åˆã‚ã›ã‚‹ï¼ˆå³æ™‚ä»£å…¥ã§ç¢ºå®Ÿã«ï¼‰
        const viewH = codeContainer.clientHeight;
        codeContainer.scrollTop = Math.max(0, top + height / 2 - viewH / 2);

        if (currentActive) currentActive.classList.remove("active");
        if (box) {
          box.classList.add("active");
          currentActive = box;
        }

        if (addHistory && name) {
          const last = navStack[navStack.length - 1];
          if (!last || last.name !== name) {
            navStack.push({ name, start: startLine, end: endLine, box });
            if (navStack.length > 10) navStack.shift();
          }
        }
        renderNav();
      }

      // â”€â”€â”€ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º â”€â”€â”€
      function renderNav() {
        const canBack = navStack.length >= 2;
        backBtn.disabled = !canBack;
        backFloat.classList.toggle("visible", canBack);

        if (navStack.length === 0) {
          breadcrumb.innerHTML =
            '<span class="bc-hint">ğŸ“ å·¦ã®é–¢æ•°ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆè¡¨ç¤ºã•ã‚Œã¾ã™</span>';
          return;
        }
        const parts = navStack.map((item, i) => {
          const isCurrent = i === navStack.length - 1;
          return `<span class="${isCurrent ? "bc-current" : "bc-item"}" data-idx="${i}">${item.name}</span>`;
        });
        breadcrumb.innerHTML =
          '<span class="bc-hint">ğŸ“ </span>' +
          parts.join('<span class="bc-sep"> â†’ </span>');
        breadcrumb.querySelectorAll(".bc-item").forEach((el) => {
          el.addEventListener("click", () => {
            const idx = parseInt(el.dataset.idx, 10);
            navStack.splice(idx + 1);
            const target = navStack[navStack.length - 1];
            if (target)
              highlightLines(target.start, target.end, target.box, null, false);
            renderNav();
          });
        });
      }

      // â”€â”€â”€ æˆ»ã‚‹ãƒœã‚¿ãƒ³ â”€â”€â”€
      function goBack() {
        if (navStack.length < 2) return;
        navStack.pop();
        const prev = navStack[navStack.length - 1];
        if (prev) highlightLines(prev.start, prev.end, prev.box, null, false);
        renderNav();
      }
      backBtn.addEventListener("click", goBack);
      backFloat.addEventListener("click", (e) => {
        e.stopPropagation();
        goBack();
      });

      // â”€â”€â”€ å·¦ãƒ‘ãƒãƒ«ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚¯ãƒªãƒƒã‚¯ â”€â”€â”€
      document.querySelectorAll(".fn-box[data-start]").forEach((box) => {
        box.addEventListener("click", () => {
          const s = parseInt(box.dataset.start, 10);
          const e = parseInt(box.dataset.end, 10);
          const name =
            box.dataset.name || box.querySelector(".fn-name").textContent;
          highlightLines(s, e, box, name);
        });
      });

      // â”€â”€â”€ ã‚³ãƒ¼ãƒ‰ãƒ‘ãƒãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ã‚¹ãƒãƒƒãƒˆãƒ©ã‚¤ãƒˆè§£é™¤ â”€â”€â”€
      codeContainer.addEventListener("click", (e) => {
        if (!e.ctrlKey && spotlitActive) clearSpotlight();
      });

      // â”€â”€â”€ AIãƒ›ãƒãƒ¼ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ— â”€â”€â”€
      let tooltipTimer = null;
      document.querySelectorAll(".fn-box[data-tip]").forEach((box) => {
        box.addEventListener("mouseenter", (e) => {
          clearTimeout(tooltipTimer);
          document.getElementById("tip-role").textContent =
            box.dataset.tipRole || "";
          document.getElementById("tip-name").textContent =
            box.dataset.name || "";
          document.getElementById("tip-body").innerHTML = box.dataset.tip;
          positionTooltip(e);
          tooltip.classList.add("show");
        });
        box.addEventListener("mousemove", positionTooltip);
        box.addEventListener("mouseleave", () => {
          tooltipTimer = setTimeout(() => tooltip.classList.remove("show"), 80);
        });
      });

      function positionTooltip(e) {
        const margin = 14;
        const tipW = 270;
        let x = e.clientX + margin;
        let y = e.clientY + margin;
        if (x + tipW > window.innerWidth) x = e.clientX - tipW - margin;
        if (y + tooltip.offsetHeight > window.innerHeight)
          y = e.clientY - tooltip.offsetHeight - margin;
        tooltip.style.left = Math.max(4, x) + "px";
        tooltip.style.top = Math.max(4, y) + "px";
      }
    </script>
  </body>
</html>
